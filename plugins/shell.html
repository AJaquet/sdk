<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <style>
        body{background-color:gray;}
        iframe{vertical-align: top; background-color:white;}
        #btnLoadContent,#btnLoadDesign,#btnLoadSettings{display:none}
    </style>
    <script>
            var config=null;
            function initFramaes(){
                var widgetFolder = window.location.hash.replace('#','');
                if(!widgetFolder) widgetFolder = 'examplePlugin';

                var xmlhttp = new XMLHttpRequest();
                var url = widgetFolder + "/plugin.json";

                xmlhttp.onreadystatechange = function() {
                    if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                        config = JSON.parse(xmlhttp.responseText);
                        loadFrames(widgetFolder,config);
                    }
                };
                xmlhttp.open("GET", url, true);
                xmlhttp.send();

            }

            function loadFrames(widgetFolder,config){
                ///load widget
                widget.src='./' + widgetFolder + '/widget/' + config.widget.rootPage ;
                var loadCPPage=true;
                ///load control
                if(config.control.content.enabled) {
                    btnLoadContent.onclick = function () {
                        control.src='./' + widgetFolder + '/control/content/' + config.control.content.rootPage;
                    };
                    btnLoadContent.style.display ='inline';
                    btnLoadContent.click();
                    loadCPPage=false;
                }

                if(config.control.design.enabled) {
                    btnLoadDesign.onclick = function () {
                        control.src='./' + widgetFolder + '/control/design/' + config.control.design.rootPage;
                    };
                    btnLoadDesign.style.display ='inline';
                    if(loadCPPage)btnLoadDesign.click();
                    loadCPPage=false;
                }

                if(config.control.settings.enabled) {
                    btnLoadDesign.onclick = function () {
                        control.src='./' + widgetFolder + '/control/settings/' + config.control.settings.rootPage;
                    };
                    btnLoadSettings.style.display ='inline';
                    if(loadCPPage)btnLoadSettings.click();
                    loadCPPage=false;
                }

            }


    </script>
</head>
<body onload="initFramaes()" onhashchange="initFramaes()">
    <div class="controlButtons" style="margin:100px 100px 25px;">
        <button id="btnLoadContent">Content</button>
        <button id="btnLoadDesign">Design</button>
        <button id="btnLoadSettings">Settings</button>
    </div>
    <iframe id="control" style="border:none;width:640px;margin:0px 100px 25px;height:595px;" seamless sandbox="allow-scripts allow-forms"></iframe>

    <iframe id="widget" style="border:none;width:350px;margin-top:0px;height:595px" seamless sandbox="allow-scripts allow-forms"></iframe>
</body>
</html>