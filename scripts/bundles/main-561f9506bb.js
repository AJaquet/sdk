"use strict";if("undefined"==typeof buildfire)throw"please add buildfire.js first to use carousel components";if("undefined"==typeof $)throw"please add JQuery first to use carousel components";"undefined"==typeof buildfire.components&&(buildfire.components={}),"undefined"==typeof buildfire.components.carousel&&(buildfire.components.carousel={}),buildfire.components.carousel._resizeImage=function(e,t){return e?buildfire.imageLib.resizeImage(e,t):""},buildfire.components.carousel._cropImage=function(e,t){return e?buildfire.imageLib.cropImage(e,t):""},buildfire.components.carousel._getDomSelector=function(e){if(e&&e.nodeType&&1===e.nodeType)return e;if("string"==typeof e){if(e=document.querySelector(e))return e;throw"selector is not a valid DOM selector"}throw"selector is not a valid DOM element nor string selector"},buildfire.components.carousel.editor=function(e,t){if("undefined"==typeof Sortable)throw"please add Sortable first to use carousel components";this.selector=e,this.items=[],this.init(e),this.loadItems(t)},buildfire.components.carousel.editor.prototype={init:function(e){this.selector=buildfire.components.carousel._getDomSelector(e),this._renderTemplate(),this.itemsContainer=this.selector.querySelector(".carousel-items"),this._initEvents()},onItemChange:function(e,t){throw"please handle onItemChange"},onOrderChange:function(e,t,i){console.warn("please handle onOrderChange",e,t,i)},onAddItems:function(e){console.warn("please handle onAddItems",item)},onDeleteItem:function(e,t){console.warn("please handle onDeleteItem",e)},loadItems:function(e,t){if(e&&e instanceof Array){t||0===this.items.length||this._removeAll();for(var i=0;i<e.length;i++)this.items.push(e[i]),this._appendItem(e[i])}},append:function(e){e&&(e instanceof Array||"object"!=typeof e||(e=[e]),this.loadItems(e,!0))},clear:function(){this._removeAll(),this.onDeleteItem()},_removeAll:function(){this.items=[];for(var e=this.itemsContainer.firstChild;e;)this.itemsContainer.removeChild(e),e=this.itemsContainer.firstChild},_appendItem:function(e){var t=this,i=document.createElement("div"),n=document.createElement("span"),o=document.createElement("div"),s=document.createElement("img"),r=document.createElement("div"),l=document.createElement("span"),a=document.createElement("div"),d=document.createElement("a"),c=document.createElement("span");i.className="d-item",n.className="icon icon-menu pull-left",o.className="media-holder pull-left",r.className="copy pull-right",l.className="title ellipsis",a.className="pull-right",d.className="text-primary text",c.className="btn-icon btn-delete-icon btn-danger transition-third",s.src=buildfire.components.carousel._resizeImage(e.iconUrl,{width:80,height:40}),l.innerHTML=e.title,d.innerHTML=e.action&&"noAction"!=e.action?"Edit Action/Link":"Add Action/Link",i.appendChild(n),i.appendChild(o),o.appendChild(s),r.appendChild(l),a.appendChild(d),a.appendChild(c),r.appendChild(a),i.appendChild(r),t.itemsContainer.appendChild(i),function(){d.addEventListener("click",function(i){i.preventDefault();var n=t._getItemIndex(e),o=i.target,s=o.parentNode.parentNode.parentNode;t._openActionItem(e,function(i){t.items[n]=i,e=i,t.onItemChange(i,n),s.querySelector("img").src=buildfire.components.carousel._resizeImage(i.iconUrl,{width:80,height:40}),s.querySelector(".title").innerHTML=i.title,o.innerHTML=i.action&&"noAction"!=i.action?"Edit Action":"Add Action"})}),c.addEventListener("click",function(i){i.preventDefault();var n=t._getItemIndex(e),o=this.parentNode.parentNode.parentNode;-1!=n&&(t.items.splice(n,1),o.parentNode.removeChild(o),t.onDeleteItem(e,n))})}(e)},_renderTemplate:function(){var e=document.createElement("div"),t=document.createElement("span"),i=document.createElement("div"),n=document.createElement("div"),o=document.createElement("a"),s=document.createElement("div");e.className="item clearfix row",t.className="labels col-md-3 padding-right-zero pull-left",t.innerHTML="Image Carousel",i.className="main col-md-9 pull-right",n.className="clearfix",o.className="btn btn-success pull-left add-new-carousel",s.className="carousel-items hide-empty draggable-list-view margin-top-twenty border-radius-four border-grey",o.innerHTML="Add Image",e.appendChild(t),n.appendChild(o),i.appendChild(n),i.appendChild(s),e.appendChild(i),this.selector.appendChild(e)},_initEvents:function(){var e=this,t=0;e.selector.querySelector(".add-new-carousel").addEventListener("click",function(){e._openImageLib(function(t){for(var i=[],n=null,o=0;o<t.length;o++)n=buildfire.actionItems.create(null,t[o],"image"),n.action||(n.action="noAction"),i.push(n),n=null;i.length&&(e.loadItems(i,!0),e.onAddItems(i))})}),e.sortableList=Sortable.create(e.itemsContainer,{animation:150,onUpdate:function(i){var n=e._getSortableItemIndex(i.item),o=e.items[t];if(n>t)for(var s=t+1;n>=s;s++)e.items[s-1]=e.items[s];else for(var s=t-1;s>=n;s--)e.items[s+1]=e.items[s];e.items[n]=o,e.onOrderChange(o,t,n)},onStart:function(i){t=e._getSortableItemIndex(i.item)}})},_openActionItem:function(e,t){buildfire.actionItems.showDialog(e,{showIcon:!0,allowNoAction:!0},function(e,i){e?console.error("Error getting item details: ",e):i&&t(i)})},_openImageLib:function(e){buildfire.imageLib.showDialog({multiSelect:!0,showIcons:!1},function(t,i){t?console.error("Error getting images: ",t):e(i.selectedFiles)})},_getItemIndex:function(e){return this.items.indexOf(e)},_getSortableItemIndex:function(e){for(var t=0;null!=(e=e.previousSibling);)t++;return t}},buildfire.components.carousel.view=function(e,t,i,n){if("object"!=typeof $.fn||!$.fn||!$.fn.owlCarousel)throw"please add owlCarousel.js first to use carousel component";this.selector=e,this.items=[],this._initDimensions(i),this._loadItems(t,!1),this.init(e,n),window.dispatchEvent(new CustomEvent("resize"))},buildfire.components.carousel.view.prototype={init:function(e,t){this.selector=buildfire.components.carousel._getDomSelector(e),this._renderSlider();var i=this;this._loadImages(t,function(){i.items.length?"undefined"==typeof t?i._applySlider():i._applySlider(t):i._hideSlider()})},loadItems:function(e,t,i,n){this.$slider&&(this._destroySlider(),this._removeAll()),this._initDimensions(i),this._renderSlider(),this._loadItems(e,t);var o=this;this._loadImages(n,function(){o.items.length?o._showSlider():o._hideSlider(),e instanceof Array&&!e.length&&!t||o._applySlider(n)})},append:function(e){e&&(e instanceof Array||"object"!=typeof e||(e=[e]),this.loadItems(e,!0))},_initDimensions:function(e){this.width=window.innerWidth,e=e||"WideScreen","WideScreen"==e?this.height=Math.ceil(9*this.width/16):"Square"==e?this.height=this.width:"Cinema"==e?this.height=Math.ceil(1*this.width/2.39):"MobileScreen"==e&&(this.height=window.innerHeight/this.width*this.width,this.width=this.width),this.cssWidth=this.width+"px",this.height>380?this.cssHeight="380px":this.cssHeight=this.height+"px",this._minHeight="180px",this._minHeight=this.cssHeight},_removeAll:function(){if(this.$slider)for(var e=this.$slider.get(0),t=e.firstChild;t;)e.removeChild(t),t=e.firstChild},_loadItems:function(e,t){if(!t&&this.items.length&&(this.items=[]),e&&e instanceof Array&&e.length)for(var i=0;i<e.length;i++)this.items.push(e[i])},_hideSlider:function(){this.selector.style.display="none"},_showSlider:function(){this.selector.style.display="block"},_applySlider:function(e){var t=this;if(t.$slider=$(t.selector),t.items.length>1){var i={navigation:!1,dots:!1,slideSpeed:800,paginationSpeed:800,singleItem:!0,pagination:!1,items:1,itemsMobile:!0,lazyLoad:!0,autoHeight:!1,autoplay:!0,autoplaySpeed:800};i.autoplay=0==e?0:3e3,i.autoplayTimeout=e?e:5e3,i.loop=!0,t.$slider.owlCarousel(i)}"undefined"==typeof e?$(".plugin-slide").show():$(".my-slide").show()},_destroySlider:function(){if(this.$slider&&this.$slider.data){var e=this.$slider.data("owlCarousel");e&&(this.$slider.trigger("autoplay.stop.owl"),this.$slider.trigger("autoplay.loop.owl",!1),e.destroy())}},_renderSlider:function(){var e=this;e.selector.style["min-height"]=e._minHeight,e.selector.style.position="relative",e.selector.style.top="0px",e.selector.style.left="0px",e.selector.className="plugin-slider text-center"},_loadImages:function(e,t){var i=this.items,n=i.length,o=n;0==n&&t();for(var s=0;n>s;s++)this._appendItem(i[s],s,e,function(){o--,0==o&&t()})},_appendItem:function(e,t,i,n){var o=document.createElement("div");"undefined"==typeof i?o.className="plugin-slide":o.className="my-slide",0!=t&&(o.style.display="none"),o.addEventListener("click",function(){buildfire.actionItems.execute(e,function(e,t){e&&console.warn("Error openning slider action: ",e)})});var s=this,r=document.createElement("img");s.$slider=$(s.selector),buildfire.imageLib.local.cropImage(e.iconUrl,{width:this.width,height:this.height},function(e,t){e?console.log("Error occurred while cropping image: ",e):(r.src=t,r.style.transform="translateZ(0)",o.appendChild(r),s.selector.appendChild(o)),n()})}};
"use strict";if("undefined"==typeof buildfire)throw"please add buildfire.js first to use pluginInstances sortableList components";if("undefined"==typeof buildfire.notifications)throw"please add notifications.js first to use pluginInstances sortableList components";"undefined"==typeof buildfire.components&&(buildfire.components={}),"undefined"==typeof buildfire.components.pluginInstance&&(buildfire.components.pluginInstance={}),buildfire.components.pluginInstance.getAllPlugins=function(e,t){if("function"==typeof e?(t=e,e={pageIndex:0,pageSize:50}):"number"==typeof e&&(e={pageIndex:e,pageSize:50}),!t)throw"Please provide a callback forget AllPlugins";buildfire.pluginInstance.search(e,function(e,n){e&&console.error("Error searching plugins: ",e);var i=buildfire.components.pluginInstance._mapFromSearch(n);console.log(n),t(e,{total:n.totalRecord,data:i})})},buildfire.components.pluginInstance._mapFromSearch=function(e){var t=[],n=[],i=0,l=null,o=null;if(e.result&&e.result instanceof Array){n=e.result,i=n.length;for(var a=0;i>a;a++)l=n[a],l.data&&l.data._buildfire&&(o={},o.folderName=l.data._buildfire.pluginType.result[0].folderName,o.instanceId=l.data.instanceId,o.iconUrl=l.data.iconUrl,o.pluginTypeId=l.data._buildfire.pluginType.data,o.pluginTypeName=l.data._buildfire.pluginType.result[0].name,o.title=l.data.title,o.iconClassName=l.data.iconClassName,t.push(o),o=null,l=null)}return t},buildfire.components.pluginInstance.sortableList=function(e,t,n,i,l){if("undefined"==typeof Sortable)throw"please add Sortable first to use sortableList components";this.selector=e,this.items=[],this.loadedInstances=[],this.checkId="loadAllPlugins"+Math.floor(1e3*Math.random()+1),this.loadAllSelector="#"+this.checkId,this.hideLoadButton=l,this._loadAllItems=!!i,this.dialogOptions="object"==typeof n&&null!=n?n:{showIcon:!0,confirmDeleteItem:!0},this.init(e),this.loadItems(t)},buildfire.components.pluginInstance.sortableList.prototype={init:function(e){this.selector=this._getDomSelector(e),this._renderTemplate(),this.itemsContainer=this.selector.querySelector(".draggable-list-view"),this._initEvents()},onOrderChange:function(e,t,n){console.warn("please handle onOrderChange",e,t,n)},onAddItems:function(e){console.warn("please handle onAddItems",e)},onDeleteItem:function(e,t){console.warn("please handle onDeleteItem",e)},onLoadAll:function(e){console.warn("please handle onLoadAll",e)},onUnloadAll:function(){console.warn("please handle onUnloadAll")},loadAllItems:function(){this._loadAllItems=!0,this.selector.querySelector(this.loadAllSelector).setAttribute("checked",!0),this._toggleAddButton("disable")},loadItems:function(e,t,n){if(e&&e instanceof Array){t||0===this.items.length||this._removeAll(),"loadAll"!=t&&"loadAll"!=n||(this._loadAllItems=!0,this.selector.querySelector(this.loadAllSelector).setAttribute("checked",!0),this._toggleAddButton("disable"));for(var i=0;i<e.length;i++)this.items.push(e[i]),this.loadedInstances.push(e[i].instanceId),this._appendItem(e[i])}},append:function(e){e&&(e instanceof Array||"object"!=typeof e||(e=[e]),this.loadItems(e,!0))},clear:function(){this._removeAll(),this.onDeleteItem()},_removeAll:function(){this.items=[],this.loadedInstances=[];for(var e=this.itemsContainer.firstChild;e;)this.itemsContainer.removeChild(e),e=this.itemsContainer.firstChild},_appendItem:function(e){var t=this,n=document.createElement("div"),i=document.createElement("span"),l=null,o=null,a=document.createElement("div"),s=document.createElement("span"),d=document.createElement("div"),r=document.createElement("span"),c=document.createElement("span");n.className="d-item clearfix",i.className="icon icon-menu cursor-grab pull-left",a.className="copy pull-right",s.className="title ellipsis item-title",d.className="pull-right",r.className="btn-icon btn-link-icon btn-primary",c.className="btn-icon btn-delete-icon btn-danger transition-third",s.innerHTML=e.title,n.appendChild(i),1==this.dialogOptions.showIcon&&(l=document.createElement("div"),l.className="media-holder pull-left",e.iconUrl?(o=document.createElement("img"),o.src=this._resizeImage(e.iconUrl,{width:80,height:40}),l.appendChild(o)):e.iconClassName&&(o=document.createElement("i"),o.className="main-icon "+e.iconClassName,l.appendChild(o)),n.appendChild(l)),a.appendChild(s),d.appendChild(r),d.appendChild(c),a.appendChild(d),n.appendChild(a),t.itemsContainer.appendChild(n),function(){r.addEventListener("click",function(t){t.preventDefault(),buildfire.navigation.navigateTo({pluginId:e.pluginTypeId,instanceId:e.instanceId,folderName:e.folderName,title:e.title})}),c.addEventListener("click",function(n){n.preventDefault();var i=function(){var n=t._getItemIndex(e),i=t.items[n].instanceId,l=c.parentNode.parentNode.parentNode;-1!=n&&(t.items.splice(n,1),t.loadedInstances.splice(t.loadedInstances.indexOf(i),1),l.parentNode.removeChild(l),t.onDeleteItem(e,n))};t.dialogOptions.confirmDeleteItem?buildfire.notifications.confirm({title:"Remove Plugin Instance",message:'<p>Are you sure you want to do this?</p>			<p class="margin-zero">Note: If you would like to add it again, you can do so by clicking the button above.</p>',buttonLabels:["Delete","Cancel"],target:n.currentTarget},function(e){i()}.bind(this)):i()})}(e)},_getOffset:function(e){return e=e.getBoundingClientRect(),{left:e.left+window.scrollX,top:e.top+window.scrollY}},_renderTemplate:function(){var e=document.createElement("div"),t=document.createElement("div"),n=document.createElement("div"),i=document.createElement("div"),l=document.createElement("div"),o=document.createElement("input"),a=document.createElement("label"),s=document.createElement("button"),d=document.createElement("div");o.setAttribute("type","checkbox"),this._loadAllItems?o.setAttribute("checked","checked"):o.removeAttribute("checked"),e.className="item clearfix row margin-bottom-fifteen",t.className="labels col-md-3 padding-right-zero pull-left",t.innerHTML="Plugin Instances",n.className="main col-md-9 pull-right",i.className="clearfix",l.className="checkbox checkbox-primary",s.className="btn btn-success pull-left add-new-item",d.className="carousel-items hide-empty draggable-list-view margin-top-twenty border-radius-four border-grey",s.innerHTML="Add Plugin Instance",a.innerHTML="Load all plugin instances",a.setAttribute("for",this.checkId),o.id=this.checkId,l.appendChild(o),l.appendChild(a),e.appendChild(t),i.appendChild(s),n.appendChild(i),n.appendChild(l),n.appendChild(d),e.appendChild(n),this.hideLoadButton&&(l.style.display="none"),this.selector.appendChild(e)},_initEvents:function(){var e=this,t=0;e.selector.querySelector(".add-new-item").addEventListener("click",function(){e._openPluginInstance({},function(t){var n,i=0,l=[];if(t instanceof Array){n=t.length;for(var o=0;n>o;o++)-1==e.loadedInstances.indexOf(t[o].instanceId)&&(e.items.push(t[o]),l.push(t[o]),e._appendItem(t[o]),e.loadedInstances.push(t[o].instanceId),i++);i>0&&e.onAddItems(l)}})}),e.selector.querySelector(this.loadAllSelector).addEventListener("change",function(){this.checked?(e._toggleAddButton("disable"),e.onLoadAll()):(e.onUnloadAll(),e._toggleAddButton("enable"))}),e.sortableList=Sortable.create(e.itemsContainer,{animation:150,onUpdate:function(n){var i=e._getSortableItemIndex(n.item),l=e.items[t];if(i>t)for(var o=t+1;i>=o;o++)e.items[o-1]=e.items[o];else for(var o=t-1;o>=i;o--)e.items[o+1]=e.items[o];e.items[i]=l,e.onOrderChange(l,t,i)},onStart:function(n){t=e._getSortableItemIndex(n.item)}})},_openPluginInstance:function(e,t){buildfire.pluginInstance.showDialog(e,function(e,n){e?console.error("Error getting item details: ",e):n&&t(n)})},_getItemIndex:function(e){return this.items.indexOf(e)},_getSortableItemIndex:function(e){for(var t=0;null!=(e=e.previousSibling);)t++;return t},_getDomSelector:function(e){if(e&&e.nodeType&&1===e.nodeType)return e;if("string"==typeof e){if(e=document.querySelector(e))return e;throw"selector is not a valid DOM selector"}throw"selector is not a valid DOM element nor string selector"},_resizeImage:function(e,t){return e?buildfire.imageLib.resizeImage(e,t):""},_toggleAddButton:function(e){var t=this.selector.querySelector(".add-new-item");"enable"==e?t.removeAttribute("disabled"):t.setAttribute("disabled","disabled")}};
//# sourceMappingURL=maps/main-561f9506bb.js.map