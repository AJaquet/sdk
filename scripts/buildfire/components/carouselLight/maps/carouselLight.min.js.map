{"version":3,"sources":["scripts/buildfire/components/carouselLight/carouselLight.js"],"names":["buildfire","components","carousel","scripts","document","getElementsByTagName","carouselScriptSrc","i","length","src","toLowerCase","indexOf","loryScript","createElement","_lightCarouselLoaded","console","log","onload","head","appendChild","loryStyle","href","rel","view","options","arguments","selector","items","layout","speed","this","config","mergeSettings","_initDimensions","init","prototype","settings","loop","autoInterval","userSttings","attrname","validateLauncherCarousel","getContext","err","result","device","platform","navigation","onAppLauncherActive","self","_applySlider","onAppLauncherInactive","_destroySlider","querySelector","_renderHTMLItems","lorySlider","destroy","timerInterval","clearInterval","lory","classNameSlideContainer","classNameFrame","ease","rewindSpeed","slideSpeed","slidesToScroll","infinite","enableMouseEvents","setInterval","next","callback","firstChild","removeChild","sliderFrame","forEach","cname","classList","add","slideContainer","_loadImages","itemsLength","pending","_appendItem","itemSlide","item","slide","addEventListener","actionItems","execute","warn","imageLib","local","cropImage","iconUrl","width","height","image","append","Array","push","window","innerWidth","Math","ceil","innerHeight","cssWidth","cssHeight","_minHeight"],"mappings":"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","file":"../carouselLight.min.js","sourcesContent":["'use strict';\n\nif (typeof (buildfire) == \"undefined\") throw (\"please add buildfire.js first to use carousel components\");\n\nif (typeof (buildfire.components) == \"undefined\")\n    buildfire.components = {};\n\nif (typeof (buildfire.components.carousel) == \"undefined\")\n    buildfire.components.carousel = {};\n\n(function () {\n    var scripts = document.getElementsByTagName('script');\n    var carouselScriptSrc = null;\n\n    for (var i = 0; i < scripts.length; i++) {\n        if (scripts[i].src && scripts[i].src.toLowerCase().indexOf('buildfire/components/carousellight/carousellight.js')) {\n            carouselScriptSrc = scripts[i].src;\n        }\n    }\n\n    if (carouselScriptSrc) {\n        //inject lory script\n        var loryScript = document.createElement('script');\n        loryScript.src = carouselScriptSrc + '/../../../../lory/lory.min.js';\n\n        //check if callback function exists; this function can be overridden and it's for knowing that lory.js has been loaded\n        //this is useful when you are lazy loading  carouselLight.js\n        if(typeof _lightCarouselLoaded != \"function\"){\n            var _lightCarouselLoaded = function () {\n                console.log('lory.js loaded');\n            };\n        }\n\n        loryScript.onload = _lightCarouselLoaded;\n\n        console.log(loryScript.src);\n        document.head.appendChild(loryScript);\n\n        //inject lory css\n        var loryStyle = document.createElement('link');\n        loryStyle.href = carouselScriptSrc + '/../../../../lory/lory.css';\n        loryStyle.rel = 'stylesheet';\n        document.head.appendChild(loryStyle);\n    }\n    else {\n        throw (\"carousellight components not found\");\n    }\n})();\n\n// This is the class that will be used in the mobile\n//{selector:selector, items:items, layout:layout, speed:speed}\nbuildfire.components.carousel.view = function (options) {\n    if (arguments && arguments.length > 1) {\n        options = {selector: arguments[0], items: arguments[1], layout: arguments[2], speed: arguments[3]};\n    }\n    this.config = this.mergeSettings(options);\n    this._initDimensions(this.config.layout);\n    this.init();\n};\n\n// Carousel view methods\nbuildfire.components.carousel.view.prototype = {\n    mergeSettings: function (options) {\n        var settings = {\n            selector: '.js_percentage',\n            items: [],\n            layout: null,\n            speed: 200,\n            loop: true,\n            autoInterval: 5 * 1000\n        };\n        var userSttings = options;\n        for (var attrname in userSttings) {\n            settings[attrname] = userSttings[attrname];\n        }\n        return settings;\n    },\n    init: function () {\n        this.selector = typeof this.config.selector === 'string' ? document.querySelector(this.config.selector) : this.config.selector;\n\n        if (!this.selector) {\n            throw (\"selecter not found\");\n            return;\n        }\n\n        var self = this;\n\n        function validateLauncherCarousel() {\n            buildfire.getContext(function (err, result) {\n                if (result && result.device && result.device.platform && result.device.platform.toLowerCase() == 'ios') {\n                    buildfire.navigation.onAppLauncherActive(function () {\n                        self._applySlider();\n                    }, true);\n                    buildfire.navigation.onAppLauncherInactive(function () {\n                        self._destroySlider();\n                    }, true);\n                }\n            });\n        }\n\n        if (this.config.items && this.config.items.length > 0) {\n            this._renderHTMLItems(function () {\n                self._applySlider();\n                validateLauncherCarousel();\n            });\n        } else {\n            self._applySlider();\n            validateLauncherCarousel();\n        }\n    },\n    _destroySlider: function () {\n        this.lorySlider.destroy();\n        if (this.timerInterval) {\n            clearInterval(this.timerInterval);\n            this.timerInterval = null;\n        }\n    },\n    _applySlider: function () {\n        this.lorySlider = lory(this.config.selector, {\n            classNameSlideContainer: this.config.classNameSlideContainer || \"js_slides\",\n            classNameFrame: this.config.classNameFrame || 'js_frame',\n            ease: 'ease',\n            rewindSpeed: 600,//ms\n            slideSpeed: this.config.speed,//ms\n            slidesToScroll: this.config.slidesToScroll || 1,\n            infinite: this.config.infinite || 1,\n            enableMouseEvents: true\n        });\n\n        if (this.config.loop && this.config.items && this.config.items.length > 1) {\n            var self = this;\n\n            if (this.timerInterval) {\n                clearInterval(this.timerInterval);\n                this.timerInterval = null;\n            }\n\n            this.timerInterval = setInterval(function () {\n                self.lorySlider.next();\n            }, this.config.autoInterval);\n        }\n    },\n    _renderHTMLItems: function (callback) {\n        var self = this;\n\n        while (this.selector.firstChild) {\n            this.selector.removeChild(this.selector.firstChild);\n        }\n\n        this.sliderFrame = document.createElement('div');\n        ['loryFrame', 'js_frame'].forEach(function (cname) {\n            self.sliderFrame.classList.add(cname);\n        });\n\n        this.slideContainer = document.createElement('ul');\n        ['lorySlides', 'js_slides'].forEach(function (cname) {\n            self.slideContainer.classList.add(cname);\n        });\n\n        this._loadImages(this.config.items, function () {\n            ['slider', 'js_percentage', 'loryPercentage'].forEach(function (cname) {\n                self.selector.classList.add(cname);\n            });\n\n            self.sliderFrame.appendChild(self.slideContainer);\n            self.selector.appendChild(self.sliderFrame);\n\n            callback();\n        });\n    },\n    _loadImages: function (items, callback) {\n        var self = this;\n\n        var itemsLength = items.length;\n        var pending = itemsLength;\n\n        if (itemsLength == 0) {\n            callback();\n        }\n\n        for (var i = 0; i < itemsLength; i++) {\n            this._appendItem(items[i], function (itemSlide) {\n                pending--;\n                self.slideContainer.appendChild(itemSlide);\n\n                if (pending == 0) {\n                    callback();\n                }\n            });\n        }\n    },\n    _appendItem: function (item, callback) {\n        var slide = document.createElement(\"li\");\n        slide.classList.add('js_slide');\n\n        slide.addEventListener(\"click\", function () {\n            buildfire.actionItems.execute(item, function (err, result) {\n                if (err) {\n                    console.warn('Error openning slider action: ', err);\n                }\n            });\n        });\n\n        buildfire.imageLib.local.cropImage(item.iconUrl, {\n            width: this.width,\n            height: this.height\n        }, function (err, result) {\n            if (!err) {\n                var image = document.createElement(\"img\");\n                image.src = result;\n                slide.appendChild(image);\n            }\n            else\n                console.log('Error occurred while cropping image: ', err);\n\n            callback(slide);\n        });\n    },\n    // allows you to append a single item or an array of items\n    append: function (items) {\n        if (!items)\n            return;\n        else if (!(items instanceof Array) && typeof(items) == \"object\")\n            items = [items];\n\n        if (items && items instanceof Array && items.length) {\n            for (var i = 0; i < items.length; i++) {\n                this.items.push(items[i]);\n            }\n\n            var self = this;\n            this._loadImages(items, function () {\n                self._applySlider();\n            });\n        }\n    },\n    _initDimensions: function (layout) {\n        this.width = window.innerWidth;\n        layout = layout || \"WideScreen\";\n        if (layout == \"WideScreen\") {\n            this.height = Math.ceil(9 * this.width / 16);\n        } else if (layout == \"Square\") {\n            this.height = this.width;\n        } else if (layout == \"Cinema\") {\n            this.height = Math.ceil(1 * this.width / 2.39);\n        } else if (layout == \"MobileScreen\") {\n            this.height = (window.innerHeight / this.width) * this.width;\n            this.width = this.width;\n        }\n\n        this.cssWidth = this.width + \"px\";\n        if (this.height > 380) {\n            this.cssHeight = '380px';\n        } else {\n            this.cssHeight = this.height + \"px\";\n        }\n\n        // Set Min height on carousel so doesn't push content down on load.\n        this._minHeight = '180px';\n        this._minHeight = this.cssHeight;\n    }\n};"]}